(function(B){"object"===typeof exports&&"undefined"!==typeof module?module.exports=B():"function"===typeof define&&define.amd?define([],B):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).dice=B()})(function(){return function r(q,n,u){function f(c,g){if(!n[c]){if(!q[c]){var b="function"==typeof require&&require;if(!g&&b)return b(c,!0);if(h)return h(c,!0);b=Error("Cannot find module '"+c+"'");throw b.code="MODULE_NOT_FOUND",b;}b=n[c]={exports:{}};
q[c][0].call(b.exports,function(g){var b=q[c][1][g];return f(b?b:g)},b,b.exports,r,q,n,u)}return n[c].exports}for(var h="function"==typeof require&&require,b=0;b<u.length;b++)f(u[b]);return f}({1:[function(r,q,n){q.exports={name:"dice.js",version:"0.8.0",description:"A parser and evaluator for a useful rpg dice syntax.",main:"src/dice.js",directories:{test:"tests"},dependencies:{},devDependencies:{karma:"~0.10.8","karma-chrome-launcher":"~0.1.1","karma-coffee-preprocessor":"~0.1.1","karma-firefox-launcher":"~0.1.2",
"karma-html2js-preprocessor":"~0.1.0","karma-jasmine":"~0.1.5","karma-phantomjs-launcher":"~0.1.1","karma-requirejs":"~0.2.0","karma-script-launcher":"~0.1.0",requirejs:"~2.1.9",pegjs:"~0.9.0","jasmine-node":"~1.14.5",browserify:"~11.0.1"},scripts:{test:"make test"},repository:{type:"git",url:"https://github.com/lordnull/dice.js.git"},keywords:["rpg","dice","parser","roll","peg"],author:"Micah Warren (Lord Null)",license:"MIT",bugs:{url:"https://github.com/lordnull/dice.js/issues"},homepage:"https://github.com/lordnull/dice.js"}},
{}],2:[function(r,q,n){function u(c,g){var b=h.parse(c);return h.eval(b,g)}function f(c){if(c.expression){var g=f(c.expression);c=c.op[0];"p"===c&&(c="");return c+"( "+g+" )"}if(c.op){var g=f(c.rightSide),b=f(c.leftSide);return g+" "+c.op+" "+b}return c.rolls?c.x+c.mode+(1<c.min?c.min+"..":"")+c.max+":["+c.rolls.join(", ")+"]":c.toString()}var h={parse:r("./parser").parse,eval:r("./evaluate").eval,version:r("../package").version};h.roll=u;h.statistics=function(c,g,b){"number"==typeof g&&(b=g,g={});
g=g||{};b=b||1E3;var f=[],h;for(h=0;h<b;h++)f.push(u(c,g));c=f.reduce(function(c,b){return c+b},0)/b;g=f.reduce(function(c,b){return c<b?c:b},f[0]);b=f.reduce(function(c,b){return c>b?c:b},f[0]);return{results:f,mean:c,min:parseInt(g.toFixed()),max:parseInt(b.toFixed())}};h.stringify=f;for(var b in h)n[b]=h[b];return h},{"../package":1,"./evaluate":3,"./parser":4}],3:[function(r,q,n){function u(b){var c=[];c[b]=!0;for(b=0;b<c.length;b++)c[b]=!0;return c}function f(b){var c;c=(c=b.args)||[];c=c.map(f);
return h[b.op].apply(b,c)}var h={"static":function(){var b=this.value;return function(){return b}},lookup:function(){var b=this.value;return function(c){var g=c[b];if(void 0!=g)return g;var f=b.split(".");return b==f?g:reduceRes=f.reduce(function(c,b){if(void 0!=b)return b[c]},c)}},floor:function(b){return function(c){c=b(c);var g=new Number(Math.floor(c));g.op="floor";g.expression=c;return g}},ceil:function(b){return function(c){c=b(c);var g=new Number(Math.ceil(c));g.op="ceil";g.expression=c;return g}},
round:function(b){return function(c){c=b(c);var g=new Number(Math.round(c));g.op="round";g.expression=c;return g}},d:function(b,c){return function(g){var f=b(g),k,h,n=u(f-1).map(function(){var b=c(g);k=b.min;h=b.max;return b}),p=n.reduce(function(c,b){return c+b},0),p=new Number(p);p.rolls=n;p.min=k;p.max=h;p.x=f;p.mode="d";return p}},w:function(b,c){return function(g){var f=b(g),k,h,n=u(f-1).map(function(){var b=c(g),f=0;k=c.min;h=c.max;if(c.min===c.max)return b;for(;b===c.max;)f+=b,b=mimMax(g);
return f}),p=n.reduce(function(c,b){return c+b},0),p=new Number(p);p.rolls=n;p.min=k;p.max=h;p.x=f;p.mode="w";return p}},random:function(b,c){return function(g){var f=Math.random(),k=c(g);g=b(g);f=Math.round((k-g)*f+g);f=new Number(f);f.min=g;f.max=k;return f}},"+":function(b,c){return function(f){var h=b(f);f=c(f);var k;k=new Number(h+f);k.op="+";k.rightSide=h;k.leftSide=f;return k}},"-":function(b,c){return function(f){var h=b(f);f=c(f);var k;k=new Number(h-f);k.op="-";k.rightSide=h;k.leftSide=
f;return k}},"*":function(b,c){return function(f){var h=b(f);f=c(f);var k;k=new Number(h*f);k.op="*";k.rightSide=h;k.leftSide=f;return k}},"/":function(b,c){return function(f){var h=b(f);f=c(f);var k;k=new Number(h/f);k.op="/";k.rightSide=h;k.leftSide=f;return k}},paren_express:function(f){return function(c){c=f(c);outtots=new Number(c);outtots.op="paren_express";outtots.expression=c;return outtots}}};n.eval=function(b,c){c=c||{};return f(b)(c)};n.ops=h},{}],4:[function(r,q,n){q.exports=function(){function n(f,
h,b,c){this.message=f;this.expected=h;this.found=b;this.location=c;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}(function(f,h){function b(){this.constructor=f}b.prototype=h.prototype;f.prototype=new b})(n,Error);return{SyntaxError:n,parse:function(f){function h(a){var d=y[a],c,e;if(!d){for(c=a-1;!y[c];)c--;d=y[c];for(d={line:d.line,column:d.column,seenCR:d.seenCR};c<a;)e=f.charAt(c),"\n"===e?(d.seenCR||d.line++,d.column=1,d.seenCR=!1):"\r"===
e||"\u2028"===e||"\u2029"===e?(d.line++,d.column=1,d.seenCR=!0):(d.column++,d.seenCR=!1),c++;y[a]=d}return d}function b(a,d){var c=h(a),e=h(d);return{start:{offset:a,line:c.line,column:c.column},end:{offset:d,line:e.line,column:e.column}}}function c(a){e<s||(e>s&&(s=e,C=[]),C.push(a))}function g(){return q()}function q(){var a,c,f,b;a=e;c=w();c!==d?(f=D(),f!==d?(b=p(),b!==d?a=c={op:f,args:[c,b]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=c=p(),a===d&&(a=c=k()));return a}function k(){var a,m,b;a=e;
40===f.charCodeAt(e)?(m=T,e++):(m=d,0===l&&c(U));m!==d?(m=t(),m!==d?(m=q(),m!==d?(b=t(),b!==d?(41===f.charCodeAt(e)?(b=V,e++):(b=d,0===l&&c(W)),b!==d?a=m={op:"paren_express",args:[m]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d)):(e=a,a=d)):(e=a,a=d);return a}function r(){var a,m;a=e;m=t();m!==d?(42===f.charCodeAt(e)?(m=X,e++):(m=d,0===l&&c(Y)),m!==d?(m=t(),m!==d?a="*":(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=e,m=t(),m!==d?(47===f.charCodeAt(e)?(m=Z,e++):(m=d,0===l&&c($)),m!==d?(m=t(),m!==d?a="/":(e=a,a=d)):
(e=a,a=d)):(e=a,a=d));return a}function w(){var a,c,f,b;a=e;c=E();c!==d?(f=r(),f!==d?(b=w(),b!==d?a=c={op:f,args:[c,b]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=e,c=k(),c!==d?(f=r(),f!==d?(b=w(),b!==d?a=c={op:f,args:[c,b]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d),a===d&&(a=c=E(),a===d&&(a=c=k())));return a}function p(){var a,c,f,b;a=e;c=w();c!==d?(f=D(),f!==d?(b=p(),b!==d?a=c={op:f,args:[c,b]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=c=w(),a===d&&(a=c=k()));return a}function D(){var a,b;a=e;b=t();b!==d?
(43===f.charCodeAt(e)?(b=aa,e++):(b=d,0===l&&c(ba)),b!==d?(b=t(),b!==d?a="+":(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=e,b=t(),b!==d?(45===f.charCodeAt(e)?(b=F,e++):(b=d,0===l&&c(G)),b!==d?(b=t(),b!==d?a="-":(e=a,a=d)):(e=a,a=d)):(e=a,a=d));return a}function E(){var a,c,b,f;a=e;c=x();c!==d?(b=H(),b!==d?(f=I(),f!==d?a=c={op:b,args:[c,f]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d);a===d&&(a=e,c=H(),c!==d?(b=I(),b!==d?a=c={op:c,args:[{op:"static",value:1},b]}:(e=a,a=d)):(e=a,a=d),a===d&&(c=J(),c!==d&&(c={op:"d",
args:[{op:"static",value:1},c]}),a=c,a===d&&(a=c=x())));return a}function H(){var a;100===f.charCodeAt(e)?(a=ca,e++):(a=d,0===l&&c(da));a===d&&(119===f.charCodeAt(e)?(a=ea,e++):(a=d,0===l&&c(fa)));return a}function I(){var a;a=J();a===d&&(a=x(),a!==d&&(a={op:"random",args:[{op:"static",args:[],value:1},a]}));return a}function J(){var a,b,g;a=e;b=x();b!==d?(f.substr(e,2)===K?(g=K,e+=2):(g=d,0===l&&c(ga)),g!==d?(g=x(),g!==d?a=b={op:"random",args:[b,g]}:(e=a,a=d)):(e=a,a=d)):(e=a,a=d);return a}function t(){var a,
b;a=[];L.test(f.charAt(e))?(b=f.charAt(e),e++):(b=d,0===l&&c(M));for(;b!==d;)a.push(b),L.test(f.charAt(e))?(b=f.charAt(e),e++):(b=d,0===l&&c(M));return a}function x(){var a,b,g;l++;g=[];z.test(f.charAt(e))?(b=f.charAt(e),e++):(b=d,0===l&&c(A));if(b!==d)for(;b!==d;)g.push(b),z.test(f.charAt(e))?(b=f.charAt(e),e++):(b=d,0===l&&c(A));else g=d;g!==d&&(g=parseInt(g.join(""),10));a=g;if(a===d)if(a=e,45===f.charCodeAt(e)?(g=F,e++):(g=d,0===l&&c(G)),g!==d){b=[];z.test(f.charAt(e))?(g=f.charAt(e),e++):(g=
d,0===l&&c(A));if(g!==d)for(;g!==d;)b.push(g),z.test(f.charAt(e))?(g=f.charAt(e),e++):(g=d,0===l&&c(A));else b=d;b!==d?a=g=-1*parseInt(b.join(""),10):(e=a,a=d)}else e=a,a=d;l--;a===d&&0===l&&c(ha);b=a;b!==d&&(b={op:"static",value:b});a=b;a===d&&(a=b=N(),a===d&&(a=e,b=O(),b!==d?(g=N(),g!==d?a=b={op:b,args:[g]}:(e=a,a=d)):(e=a,a=d),a===d&&(a=e,b=O(),b!==d?(g=k(),g!==d?a=b={op:b,args:g.args}:(e=a,a=d)):(e=a,a=d))));return a}function O(){var a;102===f.charCodeAt(e)?(a=ia,e++):(a=d,0===l&&c(ja));a!==d&&
(a="floor");a===d&&(114===f.charCodeAt(e)?(a=ka,e++):(a=d,0===l&&c(la)),a!==d&&(a="round"),a===d&&(99===f.charCodeAt(e)?(a=ma,e++):(a=d,0===l&&c(na)),a!==d&&(a="ceil")));return a}function N(){var a,b,g;a=e;91===f.charCodeAt(e)?(b=oa,e++):(b=d,0===l&&c(pa));if(b!==d){b=[];P.test(f.charAt(e))?(g=f.charAt(e),e++):(g=d,0===l&&c(Q));if(g!==d)for(;g!==d;)b.push(g),P.test(f.charAt(e))?(g=f.charAt(e),e++):(g=d,0===l&&c(Q));else b=d;b!==d?(93===f.charCodeAt(e)?(g=qa,e++):(g=d,0===l&&c(ra)),g!==d?a=b=b.join(""):
(e=a,a=d)):(e=a,a=d)}else e=a,a=d;a!==d&&(a={op:"lookup",value:a});return a}var v=1<arguments.length?arguments[1]:{},d={},R={start:g},S=g,T="(",U={type:"literal",value:"(",description:'"("'},V=")",W={type:"literal",value:")",description:'")"'},X="*",Y={type:"literal",value:"*",description:'"*"'},Z="/",$={type:"literal",value:"/",description:'"/"'},aa="+",ba={type:"literal",value:"+",description:'"+"'},F="-",G={type:"literal",value:"-",description:'"-"'},ca="d",da={type:"literal",value:"d",description:'"d"'},
ea="w",fa={type:"literal",value:"w",description:'"w"'},K="..",ga={type:"literal",value:"..",description:'".."'},L=/^[ ]/,M={type:"class",value:"[ ]",description:"[ ]"},ia="f",ja={type:"literal",value:"f",description:'"f"'},ka="r",la={type:"literal",value:"r",description:'"r"'},ma="c",na={type:"literal",value:"c",description:'"c"'},oa="[",pa={type:"literal",value:"[",description:'"["'},P=/^[^[\]]/,Q={type:"class",value:"[^[\\]]",description:"[^[\\]]"},qa="]",ra={type:"literal",value:"]",description:'"]"'},
ha={type:"other",description:"integer"},z=/^[0-9]/,A={type:"class",value:"[0-9]",description:"[0-9]"},e=0,y=[{line:1,column:1,seenCR:!1}],s=0,C=[],l=0;if("startRule"in v){if(!(v.startRule in R))throw Error("Can't start parsing from rule \""+v.startRule+'".');S=R[v.startRule]}v=S();if(v!==d&&e===f.length)return v;v!==d&&e<f.length&&c({type:"end",description:"end of input"});throw function(a,b,c,d){function e(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?
1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function f(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0100-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,
function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}null!==b&&e(b);return new n(null!==a?a:f(b,c),b,c,d)}(null,C,s<f.length?f.charAt(s):null,s<f.length?b(s,s+1):b(s,s));}}}()},{}]},{},[2])(2)});
