(function(C){"object"===typeof exports&&"undefined"!==typeof module?module.exports=C():"function"===typeof define&&define.amd?define([],C):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).dice=C()})(function(){return function u(t,r,s){function e(b,a){if(!r[b]){if(!t[b]){var h="function"==typeof require&&require;if(!a&&h)return h(b,!0);if(q)return q(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=r[b]={exports:{}};
t[b][0].call(h.exports,function(a){var h=t[b][1][a];return e(h?h:a)},h,h.exports,u,t,r,s)}return r[b].exports}for(var q="function"==typeof require&&require,m=0;m<s.length;m++)e(s[m]);return e}({1:[function(u,t,r){t.exports={name:"dice.js",version:"0.9.0",description:"A parser and evaluator for a useful rpg dice syntax.",main:"src/dice.js",directories:{test:"tests"},dependencies:{},devDependencies:{karma:"~0.10.8","karma-chrome-launcher":"~0.1.1","karma-coffee-preprocessor":"~0.1.1","karma-firefox-launcher":"~0.1.2",
"karma-html2js-preprocessor":"~0.1.0","karma-jasmine":"~0.1.5","karma-phantomjs-launcher":"~0.1.1","karma-requirejs":"~0.2.0","karma-script-launcher":"~0.1.0",requirejs:"~2.1.9",pegjs:"~0.9.0","jasmine-node":"~1.14.5",browserify:"~11.0.1"},scripts:{test:"make test"},repository:{type:"git",url:"https://github.com/lordnull/dice.js.git"},keywords:["rpg","dice","parser","roll","peg"],author:"Micah Warren (Lord Null)",license:"MIT",bugs:{url:"https://github.com/lordnull/dice.js/issues"},homepage:"https://github.com/lordnull/dice.js"}},
{}],2:[function(u,t,r){function s(a,b){var g=m.parse(a);return m.eval(g,b)}function e(a,b){if("static"==a.op)return[a.value,a.value];if("lookup"==a.op){var g=m.ops.lookup.call(a,b);return[g(b),g(b)]}if("floor"==a.op)return g=e(a.args[0],b),[Math.floor(g[0]),Math.floor(g[1])];if("ceil"==a.op)return g=e(a.args[0],b),[Math.ceil(g[0]),Math.ceil(g[1])];if("round"==a.op)return g=e(a.args[0],b),[Math.round(g[0]),Math.round(g[1])];if("d"==a.op){var k=e(a.args[0],b),l=e(a.args[1],b),g=l[0]*k[0],k=l[1]*k[1];
return[g,k]}if("w"==a.op)return k=e(a.args[0],b),l=e(a.args[1],b),g=l[0]*k[0],k=l[1]*k[1],[g,k];if("random"==a.op)return g=e(a.args[0],b),k=e(a.args[1],b),[g[0],k[1]];if("+"==a.op)return k=e(a.args[0],b),l=e(a.args[1],b),g=k[0]+l[0],k=k[1]+l[1],[g,k];if("-"==a.op)return k=e(a.args[0],b),l=e(a.args[1],b),g=k[0]-l[0],k=k[1]-l[1],[g,k];if("*"==a.op)return k=e(a.args[0],b),l=e(a.args[1],b),g=k[0]*l[0],k=k[1]*l[1],[g,k];if("/"==a.op)return k=e(a.args[0],b),l=e(a.args[1],b),g=k[0]/l[1],k=k[1]/l[0],[g,k];
if("paren_express"==a.op)return e(a.args[0],b)}function q(a){if(a.expression){var b=q(a.expression);a=a.op[0];"p"===a&&(a="");return a+"( "+b+" )"}if(a.op){var b=q(a.rightSide),g=q(a.leftSide);return b+" "+a.op+" "+g}return a.rolls?a.x+a.mode+(1<a.min?a.min+"..":"")+a.max+":["+a.rolls.join(", ")+"]":a.toString()}var m={parse:u("./parser").parse,eval:u("./evaluate").eval,ops:u("./evaluate").ops,version:u("../package").version};m.roll=s;m.statistics=function(b,h,g){"number"==typeof h&&(g=h,h={});h=
h||{};g=g||1E3;var k=[],l;for(l=0;l<g;l++)k.push(s(b,h));g=k.reduce(function(b,a){return b+a},0)/g;l=k.reduce(function(b,a){return b<a?b:a},k[0]);var p=k.reduce(function(b,a){return b>a?b:a},k[0]);b=m.parse(b);h=e(b,h);return{results:k,mean:g,min:parseInt(l.toFixed()),max:parseInt(p.toFixed()),min_possible:h[0],max_possible:h[1]}};m.stringify=q;for(var b in m)r[b]=m[b];return m},{"../package":1,"./evaluate":3,"./parser":4}],3:[function(u,t,r){function s(e){var b=[];b[e]=!0;for(e=0;e<b.length;e++)b[e]=
!0;return b}function e(m){var b;b=(b=m.args)||[];b=b.map(e);return q[m.op].apply(m,b)}var q={"static":function(){var e=this.value;return function(){return e}},lookup:function(){var e=this.value;return function(b){var a=b[e];if(void 0!=a)return a;var h=e.split(".");return e==h?a:reduceRes=h.reduce(function(b,a){if(void 0!=b)return b[a]},b)}},floor:function(e){return function(b){b=e(b);var a=new Number(Math.floor(b));a.op="floor";a.expression=b;return a}},ceil:function(e){return function(b){b=e(b);
var a=new Number(Math.ceil(b));a.op="ceil";a.expression=b;return a}},round:function(e){return function(b){b=e(b);var a=new Number(Math.round(b));a.op="round";a.expression=b;return a}},d:function(e,b){return function(a){var h=e(a),g,k,l=s(h-1).map(function(){var e=b(a);g=e.min;k=e.max;return e}),p=l.reduce(function(b,a){return b+a},0),p=new Number(p);p.rolls=l;p.min=g;p.max=k;p.x=h;p.mode="d";return p}},w:function(e,b){return function(a){var h=e(a),g,k,l=s(h-1).map(function(){var e=b(a),h=0;g=b.min;
k=b.max;if(b.min===b.max)return e;for(;e===b.max;)h+=e,e=mimMax(a);return h}),p=l.reduce(function(b,a){return b+a},0),p=new Number(p);p.rolls=l;p.min=g;p.max=k;p.x=h;p.mode="w";return p}},random:function(e,b){return function(a){var h=Math.random(),g=b(a);a=e(a);h=Math.round((g-a)*h+a);h=new Number(h);h.min=a;h.max=g;return h}},"+":function(e,b){return function(a){var h=e(a);a=b(a);var g;g=new Number(h+a);g.op="+";g.rightSide=h;g.leftSide=a;return g}},"-":function(e,b){return function(a){var h=e(a);
a=b(a);var g;g=new Number(h-a);g.op="-";g.rightSide=h;g.leftSide=a;return g}},"*":function(e,b){return function(a){var h=e(a);a=b(a);var g;g=new Number(h*a);g.op="*";g.rightSide=h;g.leftSide=a;return g}},"/":function(e,b){return function(a){var h=e(a);a=b(a);var g;g=new Number(h/a);g.op="/";g.rightSide=h;g.leftSide=a;return g}},paren_express:function(e){return function(b){b=e(b);outtots=new Number(b);outtots.op="paren_express";outtots.expression=b;return outtots}}};r.eval=function(m,b){b=b||{};return e(m)(b)};
r.ops=q},{}],4:[function(u,t,r){t.exports=function(){function s(e,q,m,b){this.message=e;this.expected=q;this.found=m;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,s)}(function(e,q){function m(){this.constructor=e}m.prototype=q.prototype;e.prototype=new m})(s,Error);return{SyntaxError:s,parse:function(e){function q(d){var c=z[d],b,a;if(!c){for(b=d-1;!z[b];)b--;c=z[b];for(c={line:c.line,column:c.column,seenCR:c.seenCR};b<d;)a=e.charAt(b),
"\n"===a?(c.seenCR||c.line++,c.column=1,c.seenCR=!1):"\r"===a||"\u2028"===a||"\u2029"===a?(c.line++,c.column=1,c.seenCR=!0):(c.column++,c.seenCR=!1),b++;z[d]=c}return c}function m(d,c){var b=q(d),a=q(c);return{start:{offset:d,line:b.line,column:b.column},end:{offset:c,line:a.line,column:a.column}}}function b(d){f<v||(f>v&&(v=f,D=[]),D.push(d))}function a(){return h()}function h(){var d,b,a,e;d=f;b=l();b!==c?(a=r(),a!==c?(e=p(),e!==c?d=b={op:a,args:[b,e]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=
b=p(),d===c&&(d=b=g()));return d}function g(){var d,a,g;d=f;40===e.charCodeAt(f)?(a=R,f++):(a=c,0===n&&b(S));a!==c?(a=w(),a!==c?(a=h(),a!==c?(g=w(),g!==c?(41===e.charCodeAt(f)?(g=T,f++):(g=c,0===n&&b(U)),g!==c?d=a={op:"paren_express",args:[a]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c)):(f=d,d=c)):(f=d,d=c);return d}function k(){var d,a;d=f;a=w();a!==c?(42===e.charCodeAt(f)?(a=V,f++):(a=c,0===n&&b(W)),a!==c?(a=w(),a!==c?d="*":(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=f,a=w(),a!==c?(47===e.charCodeAt(f)?(a=X,
f++):(a=c,0===n&&b(Y)),a!==c?(a=w(),a!==c?d="/":(f=d,d=c)):(f=d,d=c)):(f=d,d=c));return d}function l(){var d,a,b,e;d=f;a=t();a!==c?(b=k(),b!==c?(e=l(),e!==c?d=a={op:b,args:[a,e]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=f,a=g(),a!==c?(b=k(),b!==c?(e=l(),e!==c?d=a={op:b,args:[a,e]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c),d===c&&(d=a=t(),d===c&&(d=a=g())));return d}function p(){var d,a,b,e;d=f;a=l();a!==c?(b=r(),b!==c?(e=p(),e!==c?d=a={op:b,args:[a,e]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=a=l(),d===c&&
(d=a=g()));return d}function r(){var d,a;d=f;a=w();a!==c?(43===e.charCodeAt(f)?(a=Z,f++):(a=c,0===n&&b($)),a!==c?(a=w(),a!==c?d="+":(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=f,a=w(),a!==c?(45===e.charCodeAt(f)?(a=E,f++):(a=c,0===n&&b(F)),a!==c?(a=w(),a!==c?d="-":(f=d,d=c)):(f=d,d=c)):(f=d,d=c));return d}function t(){var d,a,b,e;d=f;a=y();a!==c?(b=u(),b!==c?(e=G(),e!==c?d=a={op:b,args:[a,e]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c);d===c&&(d=f,a=u(),a!==c?(b=G(),b!==c?d=a={op:a,args:[{op:"static",value:1},
b]}:(f=d,d=c)):(f=d,d=c),d===c&&(a=H(),a!==c&&(a={op:"d",args:[{op:"static",value:1},a]}),d=a,d===c&&(d=a=y())));return d}function u(){var d;100===e.charCodeAt(f)?(d=aa,f++):(d=c,0===n&&b(ba));d===c&&(119===e.charCodeAt(f)?(d=ca,f++):(d=c,0===n&&b(da)));return d}function G(){var d;d=H();d===c&&(d=y(),d!==c&&(d={op:"random",args:[{op:"static",args:[],value:1},d]}));return d}function H(){var d,a,g;d=f;a=y();a!==c?(e.substr(f,2)===I?(g=I,f+=2):(g=c,0===n&&b(ea)),g!==c?(g=y(),g!==c?d=a={op:"random",args:[a,
g]}:(f=d,d=c)):(f=d,d=c)):(f=d,d=c);return d}function w(){var a,g;a=[];J.test(e.charAt(f))?(g=e.charAt(f),f++):(g=c,0===n&&b(K));for(;g!==c;)a.push(g),J.test(e.charAt(f))?(g=e.charAt(f),f++):(g=c,0===n&&b(K));return a}function y(){var a,h,k;n++;k=[];A.test(e.charAt(f))?(h=e.charAt(f),f++):(h=c,0===n&&b(B));if(h!==c)for(;h!==c;)k.push(h),A.test(e.charAt(f))?(h=e.charAt(f),f++):(h=c,0===n&&b(B));else k=c;k!==c&&(k=parseInt(k.join(""),10));a=k;if(a===c)if(a=f,45===e.charCodeAt(f)?(k=E,f++):(k=c,0===
n&&b(F)),k!==c){h=[];A.test(e.charAt(f))?(k=e.charAt(f),f++):(k=c,0===n&&b(B));if(k!==c)for(;k!==c;)h.push(k),A.test(e.charAt(f))?(k=e.charAt(f),f++):(k=c,0===n&&b(B));else h=c;h!==c?a=k=-1*parseInt(h.join(""),10):(f=a,a=c)}else f=a,a=c;n--;a===c&&0===n&&b(fa);h=a;h!==c&&(h={op:"static",value:h});a=h;a===c&&(a=h=L(),a===c&&(a=f,h=M(),h!==c?(k=L(),k!==c?a=h={op:h,args:[k]}:(f=a,a=c)):(f=a,a=c),a===c&&(a=f,h=M(),h!==c?(k=g(),k!==c?a=h={op:h,args:k.args}:(f=a,a=c)):(f=a,a=c))));return a}function M(){var a;
102===e.charCodeAt(f)?(a=ga,f++):(a=c,0===n&&b(ha));a!==c&&(a="floor");a===c&&(114===e.charCodeAt(f)?(a=ia,f++):(a=c,0===n&&b(ja)),a!==c&&(a="round"),a===c&&(99===e.charCodeAt(f)?(a=ka,f++):(a=c,0===n&&b(la)),a!==c&&(a="ceil")));return a}function L(){var a,g,h;a=f;91===e.charCodeAt(f)?(g=ma,f++):(g=c,0===n&&b(na));if(g!==c){g=[];N.test(e.charAt(f))?(h=e.charAt(f),f++):(h=c,0===n&&b(O));if(h!==c)for(;h!==c;)g.push(h),N.test(e.charAt(f))?(h=e.charAt(f),f++):(h=c,0===n&&b(O));else g=c;g!==c?(93===e.charCodeAt(f)?
(h=oa,f++):(h=c,0===n&&b(pa)),h!==c?a=g=g.join(""):(f=a,a=c)):(f=a,a=c)}else f=a,a=c;a!==c&&(a={op:"lookup",value:a});return a}var x=1<arguments.length?arguments[1]:{},c={},P={start:a},Q=a,R="(",S={type:"literal",value:"(",description:'"("'},T=")",U={type:"literal",value:")",description:'")"'},V="*",W={type:"literal",value:"*",description:'"*"'},X="/",Y={type:"literal",value:"/",description:'"/"'},Z="+",$={type:"literal",value:"+",description:'"+"'},E="-",F={type:"literal",value:"-",description:'"-"'},
aa="d",ba={type:"literal",value:"d",description:'"d"'},ca="w",da={type:"literal",value:"w",description:'"w"'},I="..",ea={type:"literal",value:"..",description:'".."'},J=/^[ ]/,K={type:"class",value:"[ ]",description:"[ ]"},ga="f",ha={type:"literal",value:"f",description:'"f"'},ia="r",ja={type:"literal",value:"r",description:'"r"'},ka="c",la={type:"literal",value:"c",description:'"c"'},ma="[",na={type:"literal",value:"[",description:'"["'},N=/^[^[\]]/,O={type:"class",value:"[^[\\]]",description:"[^[\\]]"},
oa="]",pa={type:"literal",value:"]",description:'"]"'},fa={type:"other",description:"integer"},A=/^[0-9]/,B={type:"class",value:"[0-9]",description:"[0-9]"},f=0,z=[{line:1,column:1,seenCR:!1}],v=0,D=[],n=0;if("startRule"in x){if(!(x.startRule in P))throw Error("Can't start parsing from rule \""+x.startRule+'".');Q=P[x.startRule]}x=Q();if(x!==c&&f===e.length)return x;x!==c&&f<e.length&&b({type:"end",description:"end of input"});throw function(a,b,c,e){function f(a){var b=1;for(a.sort(function(a,b){return a.description<
b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function g(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0100-\u0FFF]/g,
function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}null!==b&&f(b);return new s(null!==a?a:g(b,c),b,c,e)}(null,D,v<e.length?e.charAt(v):null,v<e.length?m(v,v+1):m(v,v));}}}()},{}]},{},[2])(2)});
