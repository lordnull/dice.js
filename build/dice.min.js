(function(C){"object"===typeof exports&&"undefined"!==typeof module?module.exports=C():"function"===typeof define&&define.amd?define([],C):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).dice=C()})(function(){return function s(k,r,v){function d(b,f){if(!r[b]){if(!k[b]){var h="function"==typeof require&&require;if(!f&&h)return h(b,!0);if(p)return p(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=r[b]={exports:{}};
k[b][0].call(h.exports,function(f){var h=k[b][1][f];return d(h?h:f)},h,h.exports,s,k,r,v)}return r[b].exports}for(var p="function"==typeof require&&require,m=0;m<v.length;m++)d(v[m]);return d}({1:[function(s,k,r){function v(b,h){var d=p.parse(b);return m.eval(d,h)}function d(b){if(b.expression){var h=d(b.expression);b=b.op[0];"p"===b&&(b="");return b+"( "+h+" )"}if(b.op){var h=d(b.rightSide),m=d(b.leftSide);return h+" "+b.op+" "+m}return b.rolls?b.x+b.mode+(1<b.min?b.min+"..":"")+b.max+":["+b.rolls.join(", ")+
"]":b.toString()}k={};var p=s("./parser.js"),m=s("./evaluate.js");k.parse=p.parse;k.eval=m.eval;k.version="0.8.0";k.roll=v;k.statistics=function(b,d,m){"number"==typeof d&&(m=d,d={});d=d||{};m=m||1E3;var k=[],p;for(p=0;p<m;p++)k.push(v(b,d));b=k.reduce(function(b,d){return b+d},0)/m;d=k.reduce(function(b,d){return b<d?b:d},k[0]);m=k.reduce(function(b,d){return b>d?b:d},k[0]);return{results:k,mean:b,min:parseInt(d.toFixed()),max:parseInt(m.toFixed())}};k.stringify=d;for(var b in k)r[b]=k[b];return k},
{"./evaluate.js":2,"./parser.js":3}],2:[function(s,k,r){function v(d){var b=[];b[d]=!0;for(d=0;d<b.length;d++)b[d]=!0;return b}function d(m){var b;b=(b=m.args)||[];b=b.map(d);return p[m.op].apply(m,b)}var p={"static":function(){var d=this.value;return function(){return d}},lookup:function(){var d=this.value;return function(b){return b[d]}},floor:function(d){return function(b){b=d(b);var f=new Number(Math.floor(b));f.op="floor";f.expression=b;return f}},ceil:function(d){return function(b){b=d(b);var f=
new Number(Math.ceil(b));f.op="ceil";f.expression=b;return f}},round:function(d){return function(b){b=d(b);var f=new Number(Math.round(b));f.op="round";f.expression=b;return f}},d:function(d,b){return function(f){var h=d(f),l,k,p=v(h-1).map(function(){var d=b(f);l=d.min;k=d.max;return d}),q=p.reduce(function(b,d){return b+d},0),q=new Number(q);q.rolls=p;q.min=l;q.max=k;q.x=h;q.mode="d";return q}},w:function(d,b){return function(f){var h=d(f),l,k,p=v(h-1).map(function(){var d=b(f),h=0;l=b.min;k=b.max;
if(b.min===b.max)return d;for(;d===b.max;)h+=d,d=mimMax(f);return h}),q=p.reduce(function(b,d){return b+d},0),q=new Number(q);q.rolls=p;q.min=l;q.max=k;q.x=h;q.mode="w";return q}},random:function(d,b){return function(f){var h=Math.random(),l=b(f);f=d(f);h=Math.round((l-f)*h+f);h=new Number(h);h.min=f;h.max=l;return h}},"+":function(d,b){return function(f){var h=d(f);f=b(f);var l;l=new Number(h+f);l.op="+";l.rightSide=h;l.leftSide=f;return l}},"-":function(d,b){return function(f){var h=d(f);f=b(f);
var l;l=new Number(h-f);l.op="-";l.rightSide=h;l.leftSide=f;return l}},"*":function(d,b){return function(f){var h=d(f);f=b(f);var l;l=new Number(h*f);l.op="*";l.rightSide=h;l.leftSide=f;return l}},"/":function(d,b){return function(f){var h=d(f);f=b(f);var l;l=new Number(h/f);l.op="/";l.rightSide=h;l.leftSide=f;return l}},paren_express:function(d){return function(b){b=d(b);outtots=new Number(b);outtots.op="paren_express";outtots.expression=b;return outtots}}};r.eval=function(k,b){b=b||{};return d(k)(b)};
r.ops=p},{}],3:[function(s,k,r){k.exports=function(){function k(d,p,m,b){this.message=d;this.expected=p;this.found=m;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,k)}(function(d,k){function m(){this.constructor=d}m.prototype=k.prototype;d.prototype=new m})(k,Error);return{SyntaxError:k,parse:function(d){function p(a){var c=z[a],b,e;if(!c){for(b=a-1;!z[b];)b--;c=z[b];for(c={line:c.line,column:c.column,seenCR:c.seenCR};b<a;)e=d.charAt(b),
"\n"===e?(c.seenCR||c.line++,c.column=1,c.seenCR=!1):"\r"===e||"\u2028"===e||"\u2029"===e?(c.line++,c.column=1,c.seenCR=!0):(c.column++,c.seenCR=!1),b++;z[a]=c}return c}function m(a,c){var b=p(a),e=p(c);return{start:{offset:a,line:b.line,column:b.column},end:{offset:c,line:e.line,column:e.column}}}function b(a){e<t||(e>t&&(t=e,D=[]),D.push(a))}function f(){return h()}function h(){var a,b,d,f;a=e;b=s();b!==c?(d=E(),d!==c?(f=q(),f!==c?a=b={op:d,args:[b,f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=
b=q(),a===c&&(a=b=l()));return a}function l(){var a,g,x;a=e;40===d.charCodeAt(e)?(g=U,e++):(g=c,0===n&&b(V));g!==c?(g=u(),g!==c?(g=h(),g!==c?(x=u(),x!==c?(41===d.charCodeAt(e)?(x=W,e++):(x=c,0===n&&b(X)),x!==c?a=g={op:"paren_express",args:[g]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c)):(e=a,a=c)):(e=a,a=c);return a}function r(){var a,g;a=e;g=u();g!==c?(42===d.charCodeAt(e)?(g=Y,e++):(g=c,0===n&&b(Z)),g!==c?(g=u(),g!==c?a="*":(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=e,g=u(),g!==c?(47===d.charCodeAt(e)?(g=$,
e++):(g=c,0===n&&b(aa)),g!==c?(g=u(),g!==c?a="/":(e=a,a=c)):(e=a,a=c)):(e=a,a=c));return a}function s(){var a,b,d,f;a=e;b=F();b!==c?(d=r(),d!==c?(f=s(),f!==c?a=b={op:d,args:[b,f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=e,b=l(),b!==c?(d=r(),d!==c?(f=s(),f!==c?a=b={op:d,args:[b,f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c),a===c&&(a=b=F(),a===c&&(a=b=l())));return a}function q(){var a,b,d,f;a=e;b=s();b!==c?(d=E(),d!==c?(f=q(),f!==c?a=b={op:d,args:[b,f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=b=s(),a===
c&&(a=b=l()));return a}function E(){var a,g;a=e;g=u();g!==c?(43===d.charCodeAt(e)?(g=ba,e++):(g=c,0===n&&b(ca)),g!==c?(g=u(),g!==c?a="+":(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=e,g=u(),g!==c?(45===d.charCodeAt(e)?(g=G,e++):(g=c,0===n&&b(H)),g!==c?(g=u(),g!==c?a="-":(e=a,a=c)):(e=a,a=c)):(e=a,a=c));return a}function F(){var a,b,d,f;a=e;b=y();b!==c?(d=I(),d!==c?(f=J(),f!==c?a=b={op:d,args:[b,f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c);a===c&&(a=e,b=I(),b!==c?(d=J(),d!==c?a=b={op:b,args:[{op:"static",value:1},
d]}:(e=a,a=c)):(e=a,a=c),a===c&&(b=K(),b!==c&&(b={op:"d",args:[{op:"static",value:1},b]}),a=b,a===c&&(a=b=y())));return a}function I(){var a;100===d.charCodeAt(e)?(a=da,e++):(a=c,0===n&&b(ea));a===c&&(119===d.charCodeAt(e)?(a=fa,e++):(a=c,0===n&&b(ga)));return a}function J(){var a;a=K();a===c&&(a=y(),a!==c&&(a={op:"random",args:[{op:"static",args:[],value:1},a]}));return a}function K(){var a,g,f;a=e;g=y();g!==c?(d.substr(e,2)===L?(f=L,e+=2):(f=c,0===n&&b(ha)),f!==c?(f=y(),f!==c?a=g={op:"random",args:[g,
f]}:(e=a,a=c)):(e=a,a=c)):(e=a,a=c);return a}function u(){var a,g;a=[];M.test(d.charAt(e))?(g=d.charAt(e),e++):(g=c,0===n&&b(N));for(;g!==c;)a.push(g),M.test(d.charAt(e))?(g=d.charAt(e),e++):(g=c,0===n&&b(N));return a}function y(){var a,g,f;n++;f=[];A.test(d.charAt(e))?(g=d.charAt(e),e++):(g=c,0===n&&b(B));if(g!==c)for(;g!==c;)f.push(g),A.test(d.charAt(e))?(g=d.charAt(e),e++):(g=c,0===n&&b(B));else f=c;f!==c&&(f=parseInt(f.join(""),10));a=f;if(a===c)if(a=e,45===d.charCodeAt(e)?(f=G,e++):(f=c,0===
n&&b(H)),f!==c){g=[];A.test(d.charAt(e))?(f=d.charAt(e),e++):(f=c,0===n&&b(B));if(f!==c)for(;f!==c;)g.push(f),A.test(d.charAt(e))?(f=d.charAt(e),e++):(f=c,0===n&&b(B));else g=c;g!==c?a=f=-1*parseInt(g.join(""),10):(e=a,a=c)}else e=a,a=c;n--;a===c&&0===n&&b(ia);g=a;g!==c&&(g={op:"static",value:g});a=g;a===c&&(a=g=O(),a===c&&(a=e,g=P(),g!==c?(f=O(),f!==c?a=g={op:g,args:[f]}:(e=a,a=c)):(e=a,a=c),a===c&&(a=e,g=P(),g!==c?(f=l(),f!==c?a=g={op:g,args:f.args}:(e=a,a=c)):(e=a,a=c))));return a}function P(){var a;
102===d.charCodeAt(e)?(a=ja,e++):(a=c,0===n&&b(ka));a!==c&&(a="floor");a===c&&(114===d.charCodeAt(e)?(a=la,e++):(a=c,0===n&&b(ma)),a!==c&&(a="round"),a===c&&(99===d.charCodeAt(e)?(a=na,e++):(a=c,0===n&&b(oa)),a!==c&&(a="ceil")));return a}function O(){var a,f,h;a=e;91===d.charCodeAt(e)?(f=pa,e++):(f=c,0===n&&b(qa));if(f!==c){f=[];Q.test(d.charAt(e))?(h=d.charAt(e),e++):(h=c,0===n&&b(R));if(h!==c)for(;h!==c;)f.push(h),Q.test(d.charAt(e))?(h=d.charAt(e),e++):(h=c,0===n&&b(R));else f=c;f!==c?(93===d.charCodeAt(e)?
(h=ra,e++):(h=c,0===n&&b(sa)),h!==c?a=f=f.join(""):(e=a,a=c)):(e=a,a=c)}else e=a,a=c;a!==c&&(a={op:"lookup",value:a});return a}var w=1<arguments.length?arguments[1]:{},c={},S={start:f},T=f,U="(",V={type:"literal",value:"(",description:'"("'},W=")",X={type:"literal",value:")",description:'")"'},Y="*",Z={type:"literal",value:"*",description:'"*"'},$="/",aa={type:"literal",value:"/",description:'"/"'},ba="+",ca={type:"literal",value:"+",description:'"+"'},G="-",H={type:"literal",value:"-",description:'"-"'},
da="d",ea={type:"literal",value:"d",description:'"d"'},fa="w",ga={type:"literal",value:"w",description:'"w"'},L="..",ha={type:"literal",value:"..",description:'".."'},M=/^[ ]/,N={type:"class",value:"[ ]",description:"[ ]"},ja="f",ka={type:"literal",value:"f",description:'"f"'},la="r",ma={type:"literal",value:"r",description:'"r"'},na="c",oa={type:"literal",value:"c",description:'"c"'},pa="[",qa={type:"literal",value:"[",description:'"["'},Q=/^[a-zA-Z 0-9]/,R={type:"class",value:"[a-zA-Z 0-9]",description:"[a-zA-Z 0-9]"},
ra="]",sa={type:"literal",value:"]",description:'"]"'},ia={type:"other",description:"integer"},A=/^[0-9]/,B={type:"class",value:"[0-9]",description:"[0-9]"},e=0,z=[{line:1,column:1,seenCR:!1}],t=0,D=[],n=0;if("startRule"in w){if(!(w.startRule in S))throw Error("Can't start parsing from rule \""+w.startRule+'".');T=S[w.startRule]}w=T();if(w!==c&&e===d.length)return w;w!==c&&e<d.length&&b({type:"end",description:"end of input"});throw function(a,b,c,d){function e(a){var b=1;for(a.sort(function(a,b){return a.description<
b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function f(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0100-\u0FFF]/g,
function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}null!==b&&e(b);return new k(null!==a?a:f(b,c),b,c,d)}(null,D,t<d.length?d.charAt(t):null,t<d.length?m(t,t+1):m(t,t));}}}()},{}]},{},[1])(1)});
