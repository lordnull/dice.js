(function(n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define([],n):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).dice=n()})(function(){return function(){function n(s,q,r){function f(c,a){if(!q[c]){if(!s[c]){var h="function"==typeof require&&require;if(!a&&h)return h(c,!0);if(m)return m(c,!0);h=Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h;}h=
q[c]={exports:{}};s[c][0].call(h.exports,function(b){var a=s[c][1][b];return f(a?a:b)},h,h.exports,n,s,q,r)}return q[c].exports}for(var m="function"==typeof require&&require,c=0;c<r.length;c++)f(r[c]);return f}return n}()({1:[function(n,s,q){s.exports={name:"dice.js",version:"0.9.3",description:"A parser and evaluator for a useful rpg dice syntax.",main:"build/dice.js",directories:{test:"tests"},dependencies:{},devDependencies:{browserify:"~14.1.0","jasmine-core":"^2.5.2","jasmine-node":"~1.14.5",
karma:"~1.5.0","karma-chrome-launcher":"~2.0","karma-firefox-launcher":"~1.0.1","karma-jasmine":"~1.1","karma-phantomjs-launcher":"~1.0.4",pegjs:"~0.10.0"},scripts:{test:"make test"},repository:{type:"git",url:"https://github.com/lordnull/dice.js.git"},keywords:["rpg","dice","parser","roll","peg"],author:"Micah Warren (Lord Null)",license:"MIT",bugs:{url:"https://github.com/lordnull/dice.js/issues"},homepage:"https://github.com/lordnull/dice.js"}},{}],2:[function(n,s,q){function r(a,h){var b=c.parse(a);
return c.eval(b,h)}function f(a,h){if("static"==a.op)return[a.value,a.value];if("lookup"==a.op){var b=c.ops.lookup.call(a,h);return[b(h),b(h)]}if("floor"==a.op)return b=f(a.args[0],h),[Math.floor(b[0]),Math.floor(b[1])];if("ceil"==a.op)return b=f(a.args[0],h),[Math.ceil(b[0]),Math.ceil(b[1])];if("round"==a.op)return b=f(a.args[0],h),[Math.round(b[0]),Math.round(b[1])];if("d"==a.op){var l=f(a.args[0],h),d=f(a.args[1],h),b=d[0]*l[0],l=d[1]*l[1];return[b,l]}if("w"==a.op)return l=f(a.args[0],h),d=f(a.args[1],
h),b=d[0]*l[0],l=d[1]*l[1],[b,l];if("random"==a.op)return b=f(a.args[0],h),l=f(a.args[1],h),[b[0],l[1]];if("+"==a.op)return l=f(a.args[0],h),d=f(a.args[1],h),b=l[0]+d[0],l=l[1]+d[1],[b,l];if("-"==a.op)return l=f(a.args[0],h),d=f(a.args[1],h),b=l[0]-d[0],l=l[1]-d[1],[b,l];if("*"==a.op)return l=f(a.args[0],h),d=f(a.args[1],h),b=l[0]*d[0],l=l[1]*d[1],[b,l];if("/"==a.op)return l=f(a.args[0],h),d=f(a.args[1],h),b=l[0]/d[1],l=l[1]/d[0],[b,l];if("paren_express"==a.op)return f(a.args[0],h)}function m(a){if(a.expression){var c=
m(a.expression);a=a.op[0];"p"===a&&(a="");return a+"( "+c+" )"}if(a.op){var c=m(a.rightSide),b=m(a.leftSide);return c+" "+a.op+" "+b}return a.rolls?a.x+a.mode+(1<a.min?a.min+"..":"")+a.max+":["+a.rolls.join(", ")+"]":a.toString()}var c={parse:n("./parser").parse,eval:n("./evaluate").eval,ops:n("./evaluate").ops,version:n("../package").version};c.roll=r;c.statistics=function(a,d,b){"number"==typeof d&&(b=d,d={});d=d||{};b=b||1E3;var l=[],w;for(w=0;w<b;w++)l.push(r(a,d));b=l.reduce(function(b,a){return b+
a},0)/b;w=l.reduce(function(b,a){return b<a?b:a},l[0]);var m=l.reduce(function(b,a){return b>a?b:a},l[0]);a=c.parse(a);d=f(a,d);return{results:l,mean:b,min:parseInt(w.toFixed()),max:parseInt(m.toFixed()),min_possible:d[0],max_possible:d[1]}};c.stringify=m;for(var d in c)q[d]=c[d]},{"../package":1,"./evaluate":3,"./parser":4}],3:[function(n,s,q){function r(c){var d=[];d[c]=!0;for(c=0;c<d.length;c++)d[c]=!0;return d}function f(c){var d;d=(d=c.args)||[];d=d.map(f);return m[c.op].apply(c,d)}var m={"static":function(){var c=
this.value;return function(){return c}},lookup:function(){var c=this.value;return function(d){var a=d[c];if(void 0!=a)return a;var h=c.split(".");return c==h?a:reduceRes=h.reduce(function(b,a){if(void 0!=b)return b[a]},d)}},floor:function(c){return function(d){d=c(d);var a=new Number(Math.floor(d));a.op="floor";a.expression=d;return a}},ceil:function(c){return function(d){d=c(d);var a=new Number(Math.ceil(d));a.op="ceil";a.expression=d;return a}},round:function(c){return function(d){d=c(d);var a=
new Number(Math.round(d));a.op="round";a.expression=d;return a}},d:function(c,d){return function(a){var h=c(a),b,l,f=r(h-1).map(function(){var c=d(a);b=c.min;l=c.max;return c}),m=f.reduce(function(b,a){return b+a},0),m=new Number(m);m.rolls=f;m.min=b;m.max=l;m.x=h;m.mode="d";return m}},w:function(c,d){return function(a){var f=c(a),b,l,m=r(f-1).map(function(){var c=d(a),f=0;b=d.min;l=d.max;if(d.min===d.max)return c;for(;c===d.max;)f+=c,c=mimMax(a);return f}),n=m.reduce(function(b,a){return b+a},0),
n=new Number(n);n.rolls=m;n.min=b;n.max=l;n.x=f;n.mode="w";return n}},random:function(c,d){return function(a){var f=Math.random(),b=d(a);a=c(a);f=Math.round((b-a)*f+a);f=new Number(f);f.min=a;f.max=b;return f}},sum:function(){var c=this.addends;return function(d){var a=c.map(function(b){b[1](d)}),f=a.reduce(function(b,a){return"+"===b[0]?a+b[1]:a-b[1]},0),f=new Number(f);f.op="sum";f.addends=a;return f}},"+":function(c,d){return function(a){var f=c(a);a=d(a);var b;b=new Number(f+a);b.op="+";b.rightSide=
f;b.leftSide=a;return b}},"-":function(c,d){return function(a){var f=c(a);a=d(a);var b;b=new Number(f-a);b.op="-";b.rightSide=f;b.leftSide=a;return b}},"*":function(c,f){return function(a){var h=c(a);a=f(a);var b;b=new Number(h*a);b.op="*";b.rightSide=h;b.leftSide=a;return b}},"/":function(f,d){return function(a){var h=f(a);a=d(a);var b;b=new Number(h/a);b.op="/";b.rightSide=h;b.leftSide=a;return b}},paren_express:function(f){return function(d){d=f(d);outtots=new Number(d);outtots.op="paren_express";
outtots.expression=d;return outtots}}};q.eval=function(c,d){d=d||{};return f(c)(d)};q.ops=m},{}],4:[function(n,s,q){function r(f,m,c,d){this.message=f;this.expected=m;this.found=c;this.location=d;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}(function(f,m){function c(){this.constructor=f}c.prototype=m.prototype;f.prototype=new c})(r,Error);r.buildMessage=function(f,m){function c(b){return b.charCodeAt(0).toString(16).toUpperCase()}function d(b){return b.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+c(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+c(b)})}function a(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+c(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(b){return"\\x"+c(b)})}var h={literal:function(b){return'"'+d(b.text)+'"'},"class":function(b){var f="",c;for(c=0;c<b.parts.length;c++)f+=b.parts[c]instanceof Array?a(b.parts[c][0])+"-"+a(b.parts[c][1]):a(b.parts[c]);return"["+(b.inverted?"^":"")+f+"]"},any:function(b){return"any character"},end:function(b){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){var a=Array(b.length),f;for(f=0;f<b.length;f++)a[f]=h[b[f].type](b[f]);a.sort();if(0<a.length){for(b=
f=1;f<a.length;f++)a[f-1]!==a[f]&&(a[b]=a[f],b++);a.length=b}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(f)+" but "+(m?'"'+d(m)+'"':"end of input")+" found."};s.exports={SyntaxError:r,parse:function(f,m){function c(k,a){return{type:"literal",text:k,ignoreCase:a}}function d(k,a,b){return{type:"class",parts:k,inverted:a,ignoreCase:b}}function a(k){var a=z[k],b;if(!a){for(b=k-1;!z[b];)b--;a=z[b];for(a={line:a.line,
column:a.column};b<k;)10===f.charCodeAt(b)?(a.line++,a.column=1):a.column++,b++;z[k]=a}return a}function h(k,b){var e=a(k),f=a(b);return{start:{offset:k,line:e.line,column:e.column},end:{offset:b,line:f.line,column:f.column}}}function b(k){g<t||(g>t&&(t=g,C=[]),C.push(k))}function l(){return n()}function n(){var k;k=D();k===e&&(k=q());return k}function q(){var k,a,c;k=g;40===f.charCodeAt(g)?(a=S,g++):(a=e,0===p&&b(T));a!==e?(a=u(),a!==e?(a=n(),a!==e?(c=u(),c!==e?(41===f.charCodeAt(g)?(c=U,g++):(c=
e,0===p&&b(V)),c!==e?k=a={op:"paren_express",args:[a]}:(g=k,k=e)):(g=k,k=e)):(g=k,k=e)):(g=k,k=e)):(g=k,k=e);return k}function s(){var k,a;k=g;a=u();a!==e?(42===f.charCodeAt(g)?(a=W,g++):(a=e,0===p&&b(X)),a!==e?(a=u(),a!==e?k="*":(g=k,k=e)):(g=k,k=e)):(g=k,k=e);k===e&&(k=g,a=u(),a!==e?(47===f.charCodeAt(g)?(a=Y,g++):(a=e,0===p&&b(Z)),a!==e?(a=u(),a!==e?k="/":(g=k,k=e)):(g=k,k=e)):(g=k,k=e));return k}function y(){var a,b,f,c;a=g;b=E();b!==e?(f=s(),f!==e?(c=y(),c!==e?a=b={op:f,args:[b,c]}:(g=a,a=e)):
(g=a,a=e)):(g=a,a=e);a===e&&(a=g,b=q(),b!==e?(f=s(),f!==e?(c=y(),c!==e?a=b={op:f,args:[b,c]}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e),a===e&&(a=b=E(),a===e&&(a=b=q())));return a}function D(){var a,c,d,h;a=g;c=y();c!==e?(d=g,h=u(),h!==e?(43===f.charCodeAt(g)?(h=$,g++):(h=e,0===p&&b(aa)),h!==e?(h=u(),h!==e?d="+":(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=u(),h!==e?(45===f.charCodeAt(g)?(h=F,g++):(h=e,0===p&&b(G)),h!==e?(h=u(),h!==e?d="-":(g=d,d=e)):(g=d,d=e)):(g=d,d=e)),d!==e?(h=D(),h!==e?(a=h,"sum"!==a.op&&
(a={op:"sum",addends:[["+",a]]}),a.addends[0][0]=d,a.addends.unshift(["+",c])):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a===e&&(a=c=y(),a===e&&(a=c=q()));return a}function E(){var a,b,f,c;a=g;b=x();b!==e?(f=H(),f!==e?(c=I(),c!==e?a=b={op:f,args:[b,c]}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a===e&&(a=g,b=H(),b!==e?(f=I(),f!==e?a=b={op:b,args:[{op:"static",value:1},f]}:(g=a,a=e)):(g=a,a=e),a===e&&(b=J(),b!==e&&(b={op:"d",args:[{op:"static",value:1},b]}),a=b,a===e&&(a=b=x())));return a}function H(){var a;100===f.charCodeAt(g)?
(a=ba,g++):(a=e,0===p&&b(ca));a===e&&(119===f.charCodeAt(g)?(a=da,g++):(a=e,0===p&&b(ea)));return a}function I(){var a;a=J();a===e&&(a=x(),a!==e&&(a={op:"random",args:[{op:"static",args:[],value:1},a]}));return a}function J(){var a,c,d;a=g;c=x();c!==e?(f.substr(g,2)===K?(d=K,g+=2):(d=e,0===p&&b(fa)),d!==e?(d=x(),d!==e?a=c={op:"random",args:[c,d]}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function u(){var a,c;a=[];L.test(f.charAt(g))?(c=f.charAt(g),g++):(c=e,0===p&&b(M));for(;c!==e;)a.push(c),L.test(f.charAt(g))?
(c=f.charAt(g),g++):(c=e,0===p&&b(M));return a}function x(){var a,c,d;p++;d=[];A.test(f.charAt(g))?(c=f.charAt(g),g++):(c=e,0===p&&b(B));if(c!==e)for(;c!==e;)d.push(c),A.test(f.charAt(g))?(c=f.charAt(g),g++):(c=e,0===p&&b(B));else d=e;d!==e&&(d=parseInt(d.join(""),10));a=d;if(a===e)if(a=g,45===f.charCodeAt(g)?(d=F,g++):(d=e,0===p&&b(G)),d!==e){c=[];A.test(f.charAt(g))?(d=f.charAt(g),g++):(d=e,0===p&&b(B));if(d!==e)for(;d!==e;)c.push(d),A.test(f.charAt(g))?(d=f.charAt(g),g++):(d=e,0===p&&b(B));else c=
e;c!==e?a=d=-1*parseInt(c.join(""),10):(g=a,a=e)}else g=a,a=e;p--;a===e&&0===p&&b(ga);c=a;c!==e&&(c={op:"static",value:c});a=c;a===e&&(a=c=N(),a===e&&(a=g,c=O(),c!==e?(d=N(),d!==e?a=c={op:c,args:[d]}:(g=a,a=e)):(g=a,a=e),a===e&&(a=g,c=O(),c!==e?(d=q(),d!==e?a=c={op:c,args:d.args}:(g=a,a=e)):(g=a,a=e))));return a}function O(){var a;102===f.charCodeAt(g)?(a=ha,g++):(a=e,0===p&&b(ia));a!==e&&(a="floor");a===e&&(114===f.charCodeAt(g)?(a=ja,g++):(a=e,0===p&&b(ka)),a!==e&&(a="round"),a===e&&(99===f.charCodeAt(g)?
(a=la,g++):(a=e,0===p&&b(ma)),a!==e&&(a="ceil")));return a}function N(){var a,c,d;a=g;91===f.charCodeAt(g)?(c=na,g++):(c=e,0===p&&b(oa));if(c!==e){c=[];P.test(f.charAt(g))?(d=f.charAt(g),g++):(d=e,0===p&&b(Q));if(d!==e)for(;d!==e;)c.push(d),P.test(f.charAt(g))?(d=f.charAt(g),g++):(d=e,0===p&&b(Q));else c=e;c!==e?(93===f.charCodeAt(g)?(d=pa,g++):(d=e,0===p&&b(qa)),d!==e?a=c=c.join(""):(g=a,a=e)):(g=a,a=e)}else g=a,a=e;a!==e&&(a={op:"lookup",value:a});return a}m=void 0!==m?m:{};var e={},v={start:l},
R=l,S="(",T=c("(",!1),U=")",V=c(")",!1),W="*",X=c("*",!1),Y="/",Z=c("/",!1),$="+",aa=c("+",!1),F="-",G=c("-",!1),ba="d",ca=c("d",!1),da="w",ea=c("w",!1),K="..",fa=c("..",!1),L=/^[ ]/,M=d([" "],!1,!1),ha="f",ia=c("f",!1),ja="r",ka=c("r",!1),la="c",ma=c("c",!1),na="[",oa=c("[",!1),P=/^[^[\]]/,Q=d(["[","]"],!0,!1),pa="]",qa=c("]",!1),ga={type:"other",description:"integer"},A=/^[0-9]/,B=d([["0","9"]],!1,!1),g=0,z=[{line:1,column:1}],t=0,C=[],p=0;if("startRule"in m){if(!(m.startRule in v))throw Error("Can't start parsing from rule \""+
m.startRule+'".');R=v[m.startRule]}v=R();if(v!==e&&g===f.length)return v;v!==e&&g<f.length&&b({type:"end"});throw function(a,b,c){return new r(r.buildMessage(a,b),a,b,c)}(C,t<f.length?f.charAt(t):null,t<f.length?h(t,t+1):h(t,t));}}},{}]},{},[2])(2)});
